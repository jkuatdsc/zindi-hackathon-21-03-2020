import pandas as pd

variable_description_df = pd.read_csv("../../Data/Raw/variable_descriptions.csv")
test_df = pd.read_csv("../../Data/Raw/Test_maskedv2.csv")
train_df = pd.read_csv('../../Data/Raw/Train_maskedv2.csv')


def check_equality() -> bool:
    test_columns = list(test_df.columns)
    train_columns = list(train_df.columns)
    variables_columns = list(variable_description_df['+ACI-Column+ACI-'])
    variables_columns = [i.replace('+ACI-', '').replace("+AF8-", "_") for i in variables_columns]

    train_columns.remove("target_pct_vunerable")
    test_columns.remove("ward")
    train_columns.remove('ward')
    variables_columns.remove('target_pct_vunerable')

    if set(test_columns) == set(train_columns) and set(train_columns) == set(variables_columns):
        return True
    else:
        return False


def rename_columns() -> None:
    new_columns = list(variable_description_df['+ACI-Description+ACI-'])
    new_columns = [i.replace('+ACI-', '').replace(" ", "_") for i in new_columns]
    new_columns.insert(0, 'ward')
    train_columns = new_columns
    train_df.columns = train_columns
    new_columns.remove('Percentage_of_large_households_who_have_to_leave_their_premises_for_water')
    test_columns = new_columns
    test_df.columns = test_columns
    test_df.to_csv("../../Data/Processed/test.csv")
    train_df.to_csv('../../Data/Processed/train.csv')
    print("Finished renaming columns")


if __name__ == "__main__":
    if check_equality():
        rename_columns()
